<!DOCTYPE HTML>
<!--
	Strata by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>MeqTrees-2GC-Practicals</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="assets/css/main.css" />
		<style type="text/css">
  body { color: black; background: white; } 
</style>
		<!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->
	</head>
	<body id="top">

		<!-- Header -->
			<header id="header">
				<div class="inner">
					<a href="#" class="image avatar"><img src="images/fido.jpg" alt="" /></a>
					<h1><strong>MeqTrees Second Generation Calibration Prac Manual</strong>.</h1>
				</div>
			</header>

		<!-- Main -->
			<div id="main">

				<!-- One -->
					<section id="one">
						<header class="major">
							<h2>Introduction</h2>
						</header>
				<p> <font face="MathJax_SansSerif"> MeqTrees</font>, as
					you might have heard from the previous lectures, is simply a software 
					tool that allows us to:</p>
<ul>
 <li> Generate visibilities through simulations and
 <li> calibrate both the simulated and real astronomical data.
</ul>
<p>
<font face="MathJax_SansSerif"> MeqTrees</font> uses the Radio Interferometer Measurement Equation (RIME)  or in short, the Measurement Equation to try and predict visibilities by modelling what we think the observed sky looks like and then corrupting the model with various propagation effects. Such effects include 
the bandpass, receiver complex gains, polarisation leakage, primary beam, parallactic angle (for alt-az mount such as the JVLA, KAT7, MeerKAT) and atmospheric phases. The Measurement Equation is very flexible in a such a way that it allows the different effects to be representated as separate terms, thus, making it possible to solve for the individual effects independently. </p>
Corruption effects are generally grouped into direction independent (DI) and direction dependent (DD).
						The DI effects occur at the antennas and are
						referred to as <em>uv-</em>plane effects,
						and the DD effects occur close to an astronomical 
						object and hence, referred to as the image-plane effects.
<p>
Calibration methods developed to correct for DI effects are referred to as 2GC methods, and those that
	incorporate the correction of DD effects are 3GC methods. For this practical, we going
	to focus only on 2GC methods and the next practical will be on 3GC methods.
	The 2GC methods assume that all the effects are DI, and any effect which is DD such as the 
	primary beam is constant in time and identical across all receivers.						
I recommend the following papers for further reading on RIME and its 
	implementation on modern calibration algorithms; <a href="https://arxiv.org/abs/1101.1764">RIME1</a>,
	<a ref="https://arxiv.org/abs/1101.1765">RIME2</a> and <a href="https://arxiv.org/abs/1101.1768">RIME3</a>, 
	and also refer to therein.
</p>		
					</section>
				<!-- Two -->
					<section id="two">
						<h2> Logging to elwood and Check list </h2>

I suppose by now all of us should have access to elwood. Login to elwood, and go to a directory named "Meqtrees2GC. Inside this directory you should find:
<ol>
    <li> The sky model <font color="red"> summs_field_kat7.lsm.html </font>. This model is in <font face="MathJax_SansSerif" size="2em"> Tigger </font> format and it contains sources drawn
    from SUMSS covering approximately the field of view of the KAT-7 instrument. The survey 
	    from which they are drawn was conducted at 843 MHz so the sources have had their
	    fluxes extrapolated to what they would be at 1445 MHz assuming a spectral index of 0.7.
    
    <li> The <font color="red"> KAT_ANTENNAS </font> -- this file contains the 
	    information about the instrument such as antenna positions, 
       dish size, elevation, etc.
     
    <li> The configuration file <font color="red"> config.json </font>.
 </ol>

					</section>
				
				
		
				<!-- Three -->
					<section id="three">
						
<h3> Additional Packages: Tigger and SIMMS 
</h3>

Earlier I did mention <font face="MathJax_SansSerif"> Tigger </font> and 
	I think you deserve to know what it is. Ok, so <font face="MathJax_SansSerif"> Tigger </font> 
	is a tool designed to help us view and edit the sky models, and also to view images. 
	You might be familiar with similar tools such as <font face="MathJax_SansSerif"> kvis </font>, 
	<font face="MathJax_SansSerif"> ds9 </font>, etc. You can open the above sky model using 
	<font face="MathJax_SansSerif"> Tigger </font> by typing the command that follows, 
						and you may close it when you're done appreciating it.
	<p>
    $ tigger summs_field_kat7.lsm.html 
						</p>
<p>
We need a file in which we can write and store data (visibilities) and this file is
	called a Measurement Set (MS -- CASA Table). We are going to create an 
	empty MS file using a software package called <font face="MathJax_SansSerif"> simms </font>.			
A typical MS should contain information such as a central frequency of the observation, 
	a total observation time (synthesis time), integration time
	per visibilty point, 
	number of channels and the pointing centre defined in terms of right ascension (ra) and declination (dec).
</p>
We can provide all these information on the command line but this can become tideous. 
	An alternative approach is to provide the configuration file, see Fig 1 (with commends amended for the 
						parameters we considered). 
You can find more definitions by using <font face="MathJax_SansSerif"> simms </font> help command.

						
<figure>
  <img src="images/fulls/configcomments.jpg">
  <center> <figcaption> Figure 1. Simms Configuration File </figcaption> </center>
</figure>
<blockquote text-align:right>
For our observation, the central frequency=1445MHz, pointing centre ra = 19h 15m 53.304s,
	dec = -74d39m37.90s, the observation time=12hours, integration time=60 seconds,  
	using only a single channel of width 16MHz and all the correlation outputs. 
						</blockquote>
Lets create our MS file by running <font face="MathJax_SansSerif"> simms </font> on the command line using: <br/>
    $ <font face="MathJax_SansSerif"> simms </font> -jc config.json
  <br />
If successful, you should see the message: ##INFO: <font face="MathJax_SansSerif"> simms </font> succeeded						
						
					</section>	
			<!-- Four -->
					<section id="four">
						
				<h2>  Simulating Visibilities: No Noise and Instrumental Effects </h2>

You may be wondering why do we need to simulate the data to begin with?. Well, for our 
case we don't have much  choice since we don't have any real observed data, so we are basically 
trying to create own corrupted data which we will calibrate later :). 

<ul>
<li> But generally, you would want to simulate data to get a better understanding of the instrument.
<li> Or when you want to write observation proposal and you want to convince the time 
	allocation commitee that you've at least considered the feasibility of detecting something with
	their precious telescope time. 
</ul>

<font face="MathJax_SansSerif"> MeqTrees </font> comes bundled with a simulation framework known as 
						Siamese, and we can get to this file by:

<ul>
<li> on the command line you can open <font face="MathJax_SansSerif"> MeqTrees </font> using $meqbrowser
<li> A window will open, press start.
<li> select "TDL" then "Load TDL script"
<li> Navigate to "Cattery" folder then select "Siamese" and load "turbo-sim.py"
</ul>

Once turbo-sim.py has loaded you should be presented with a screen "TDL Compile-time options". 
You can expand or collapse any of the subsets of hierarchical options by clicking the "+" or "-" signs. 
As you can see there are a lot to choose from, and for this simulation we'll ignore most of them.

<br/> 

<figure>
  <img src="images/fulls/TDL_Compile_OptionsInitial.png" width="60%">
  <center> <figcaption> Figure 2. Simulation: Loaded the turbo-sim.py script.  </figcaption> </center>
</figure>

First, lets simulate visibilities without noise or any instrumental corruption. Here we want
to see what the instrument would observe if we had a perfect instrument, noise-free and the medium in 
which the signal is propagating is free of disturbances.

Make sure that the MS loaded is correct. If is not, click right side of MS: option and load it. 
Another important switch is the "Simulation mode: sim only" option. This just means
the visibilities generated by this simulation will overwrite whatever is in the MS.
You can also add and subtract to existing visibilities which is useful but we won't cover this. 
We're using all interferometers (synonymous with baselines) and all correlations (polarization products). 	
						
				</section> 
				
						
	
		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.poptrox.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
			<script src="assets/js/main.js"></script>

	</body>
</html>
